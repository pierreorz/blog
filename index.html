
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>邓德昭的技术博客</title>
  <meta name="author" content="pierreorz">

  
  <meta name="description" content="需求： 标准的document service很不灵活，实际开发中少不了要开发定制。那么问题来了，通过RIDC很灵活的查询出了需要的文档，如何集成到portal上去呢 分析： 使用RIDC查询出需要的文档，存放在POJO等数据模型中
利用POJO生成dataControl， &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://dengdezhao.cn">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="邓德昭的技术博客" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/libs/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="/stylesheets/google-fonts.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/default.css" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><img src="../../../../../wp-content/uploads/logo.gif" width=40px height=40px  alt="" /><a href="/">邓德昭的技术博客</a></h1>
  
    <h2>最大的懦弱，不是畏葸不前，而是安于现状</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:dengdezhao.cn" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">博客主页</a></li>
  <li><a href="/blog/archives">文章列表</a></li>
  <li><a href="/tag">标签云</a></li>
  <li><a href="/about">关于</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-11-28/shi-yong-ridczai-webcenter-portalji-cheng-ecmde-wen-dang-cha-xun-gong-neng/">使用RIDC在webcenter portal集成ECM的文档查询功能</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-11-28T17:17:00+08:00" pubdate data-updated="true">Nov 28<span>th</span>, 2014</time>
        
         | <a href="/blog/2014-11-28/shi-yong-ridczai-webcenter-portalji-cheng-ecmde-wen-dang-cha-xun-gong-neng/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h4><i class="icon-file"></i>   需求：</h4>

<p>标准的document service很不灵活，实际开发中少不了要开发定制。那么问题来了，通过RIDC很灵活的查询出了需要的文档，如何集成到portal上去呢</p>

<h4><i class="icon-folder-open"></i> 分析：</h4>

<p>使用RIDC查询出需要的文档，存放在POJO等数据模型中
利用POJO生成dataControl，开发taskflow等UI层
将以上功能开发成为extend.spaces.webapp，扩展到webcenter spaces
以下主要展现第一步：通过RIDC查询及POJO生成数据模型。</p>

<h4><i class="icon-pencil"></i> 技术实现：</h4>

<ul>
<li>使用RIDC查询文档</li>
</ul>


<p>以下是主要查询方法, query传入的即是ECM的queryText，例如：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">dDocType</span> <span class="o">&lt;</span><span class="n">matches</span><span class="o">&gt;</span> <span class="err">`</span><span class="n">PJT</span><span class="o">-</span><span class="n">INTERFACE</span><span class="o">-</span><span class="n">DOC</span><span class="err">`</span>
</span></code></pre></td></tr></table></div></figure>


<p>通过拼接好需要的查询条件以及用户便可以查询出文档。</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'>     <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;</span> <span class="nf">search</span><span class="o">(</span><span class="n">String</span> <span class="n">username</span><span class="o">,</span> <span class="n">String</span> <span class="n">query</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">ServiceResponse</span> <span class="n">serviceResponse</span> <span class="o">=</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>        <span class="n">List</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;();</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">try</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="o">(</span><span class="n">query</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>                <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>            <span class="n">IdcClient</span> <span class="n">client</span> <span class="o">=</span> <span class="n">getIdcClient</span><span class="o">();</span>
</span><span class='line'>            <span class="n">DataBinder</span> <span class="n">dataBinderReq</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="na">createBinder</span><span class="o">();</span>
</span><span class='line'>            <span class="n">dataBinderReq</span><span class="o">.</span><span class="na">putLocal</span><span class="o">(</span><span class="s">&quot;IdcService&quot;</span><span class="o">,</span> <span class="s">&quot;GET_SEARCH_RESULTS&quot;</span><span class="o">);</span>
</span><span class='line'>            <span class="n">dataBinderReq</span><span class="o">.</span><span class="na">putLocal</span><span class="o">(</span><span class="s">&quot;QueryText&quot;</span><span class="o">,</span> <span class="n">query</span><span class="o">.</span><span class="na">toString</span><span class="o">());</span>
</span><span class='line'>            <span class="n">dataBinderReq</span><span class="o">.</span><span class="na">putLocal</span><span class="o">(</span><span class="s">&quot;ResultCount&quot;</span><span class="o">,</span> <span class="s">&quot;100&quot;</span><span class="o">);</span>
</span><span class='line'>            <span class="n">serviceResponse</span> <span class="o">=</span>
</span><span class='line'>                    <span class="n">client</span><span class="o">.</span><span class="na">sendRequest</span><span class="o">(</span><span class="k">new</span> <span class="n">IdcContext</span><span class="o">(</span><span class="n">username</span><span class="o">),</span> <span class="n">dataBinderReq</span><span class="o">);</span>
</span><span class='line'>            <span class="n">DataBinder</span> <span class="n">dataBinderRes</span> <span class="o">=</span> <span class="n">serviceResponse</span><span class="o">.</span><span class="na">getResponseAsBinder</span><span class="o">();</span>
</span><span class='line'>            <span class="n">DataResultSet</span> <span class="n">resultSet</span> <span class="o">=</span>
</span><span class='line'>                <span class="n">dataBinderRes</span><span class="o">.</span><span class="na">getResultSet</span><span class="o">(</span><span class="s">&quot;SearchResults&quot;</span><span class="o">);</span>
</span><span class='line'>            <span class="k">for</span> <span class="o">(</span><span class="n">DataObject</span> <span class="n">dataObject</span> <span class="o">:</span> <span class="n">resultSet</span><span class="o">.</span><span class="na">getRows</span><span class="o">())</span> <span class="o">{</span>
</span><span class='line'>                <span class="n">Document</span> <span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Document</span><span class="o">();</span>
</span><span class='line'>                <span class="n">d</span><span class="o">.</span><span class="na">setContentId</span><span class="o">(</span><span class="n">dataObject</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;dDocName&quot;</span><span class="o">));</span>
</span><span class='line'>                <span class="n">d</span><span class="o">.</span><span class="na">setDocumentId</span><span class="o">(</span><span class="n">dataObject</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;dID&quot;</span><span class="o">));</span>
</span><span class='line'>                <span class="n">d</span><span class="o">.</span><span class="na">setOwner</span><span class="o">(</span><span class="n">dataObject</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;dDocAuthor&quot;</span><span class="o">));</span>
</span><span class='line'>                <span class="n">d</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="n">dataObject</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;dDocTitle&quot;</span><span class="o">));</span>
</span><span class='line'>                <span class="n">d</span><span class="o">.</span><span class="na">setDocType</span><span class="o">(</span><span class="n">dataObject</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;dDocType&quot;</span><span class="o">));</span>
</span><span class='line'>                <span class="n">d</span><span class="o">.</span><span class="na">setXspeciality</span><span class="o">(</span><span class="n">dataObject</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;xSPECIALTY&quot;</span><span class="o">));</span>
</span><span class='line'>                <span class="n">d</span><span class="o">.</span><span class="na">setXrcvMajor</span><span class="o">(</span><span class="n">dataObject</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&quot;xRCV_MAJOR&quot;</span><span class="o">));</span>
</span><span class='line'>                <span class="n">Date</span> <span class="n">date</span> <span class="o">=</span> <span class="n">dataObject</span><span class="o">.</span><span class="na">getDate</span><span class="o">(</span><span class="s">&quot;dInDate&quot;</span><span class="o">);</span>
</span><span class='line'>                <span class="n">SimpleDateFormat</span> <span class="n">sf</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDateFormat</span><span class="o">(</span><span class="s">&quot;yyyy/mm/dd&quot;</span><span class="o">);</span>
</span><span class='line'>                <span class="n">String</span> <span class="n">format</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="na">format</span><span class="o">(</span><span class="n">date</span><span class="o">);</span>
</span><span class='line'>                <span class="n">d</span><span class="o">.</span><span class="na">setDindate</span><span class="o">(</span><span class="n">format</span><span class="o">);</span>
</span><span class='line'>                <span class="n">list</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">d</span><span class="o">);</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">ex</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;Error Search: &quot;</span> <span class="o">+</span> <span class="n">ex</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span><span class='line'>        <span class="o">}</span> <span class="k">finally</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">if</span> <span class="o">(</span><span class="n">serviceResponse</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>                <span class="n">serviceResponse</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span><span class='line'>            <span class="o">}</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">list</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span> <span class="c1">//</span>
</span></code></pre></td></tr></table></div></figure>


<p>其中Document.java即是POJO类</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Document</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">contentId</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">documentId</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">owner</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">title</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">doctype</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">securitygroup</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">dindate</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">xDesignPhase</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">xspeciality</span><span class="o">;</span><span class="c1">//send</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">String</span> <span class="n">xrcvMajor</span><span class="o">;</span><span class="c1">//receive</span>
</span><span class='line'>     <span class="o">......</span><span class="na">get</span> <span class="n">set</span> <span class="n">accessor</span><span class="o">......</span>
</span><span class='line'><span class="o">}</span><span class="c1">//end class</span>
</span></code></pre></td></tr></table></div></figure>


<p>创建facade类：MyCondition.java，主要是调用search方法接受RIDC查询的结果集，生成dataControl供UI层使用。参考代码如下：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyCondition</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">private</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">ADFLogger</span> <span class="n">LOGGER</span> <span class="o">=</span> <span class="n">ADFLogger</span><span class="o">.</span><span class="na">createADFLogger</span><span class="o">(</span><span class="n">MyCondition</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;</span> <span class="n">receiveDocumentList</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">private</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;</span> <span class="n">sendDocumentList</span><span class="o">;</span>
</span><span class='line'>    <span class="kd">public</span> <span class="nf">MyCondition</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">this</span><span class="o">.</span><span class="na">receiveDocumentList</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;();</span>
</span><span class='line'>        <span class="k">this</span><span class="o">.</span><span class="na">sendDocumentList</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;();</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="cm">/*******</span>
</span><span class='line'><span class="cm">     * 初始化，调用RIDC API查询出文档数据集</span>
</span><span class='line'><span class="cm">     * *****/</span>
</span><span class='line'>    <span class="kd">public</span> <span class="n">String</span> <span class="nf">init</span><span class="o">(){</span>
</span><span class='line'>        <span class="n">LOGGER</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="s">&quot;start init....&quot;</span><span class="o">);</span>
</span><span class='line'>        <span class="n">Object</span> <span class="n">userId</span> <span class="o">=</span> <span class="n">JSFUtils</span><span class="o">.</span><span class="na">resolveExpression</span><span class="o">(</span><span class="s">&quot;#{securityContext.userName}&quot;</span><span class="o">);</span>
</span><span class='line'>        <span class="n">Object</span> <span class="n">projectCode</span> <span class="o">=</span> <span class="n">JSFUtils</span><span class="o">.</span><span class="na">resolveExpression</span><span class="o">(</span><span class="s">&quot;#{pageFlowScope.inputProjectCode}&quot;</span><span class="o">);</span>
</span><span class='line'>        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">spcCode</span> <span class="o">=</span> <span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;)(</span><span class="n">JSFUtils</span><span class="o">.</span><span class="na">resolveExpression</span><span class="o">(</span><span class="s">&quot;#{pageFlowScope.spcCode}&quot;</span><span class="o">)==</span><span class="kc">null</span><span class="o">?</span><span class="kc">null</span><span class="o">:</span><span class="n">JSFUtils</span><span class="o">.</span><span class="na">resolveExpression</span><span class="o">(</span><span class="s">&quot;#{pageFlowScope.spcCode}&quot;</span><span class="o">));</span>
</span><span class='line'>        <span class="k">if</span><span class="o">(</span><span class="n">userId</span><span class="o">==</span><span class="kc">null</span><span class="o">||</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">userId</span><span class="o">)){</span>
</span><span class='line'>            <span class="n">LOGGER</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="s">&quot;userId is null &quot;</span><span class="o">);</span>
</span><span class='line'>            <span class="n">FacesMessage</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FacesMessage</span><span class="o">(</span><span class="s">&quot;用户为空请重试!&quot;</span><span class="o">);</span>
</span><span class='line'>            <span class="n">JSFUtils</span><span class="o">.</span><span class="na">getFacesContext</span><span class="o">().</span><span class="na">addMessage</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">msg</span><span class="o">);</span>
</span><span class='line'>            <span class="k">return</span> <span class="s">&quot;NO&quot;</span><span class="o">;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">if</span><span class="o">(</span><span class="n">projectCode</span><span class="o">==</span><span class="kc">null</span><span class="o">||</span><span class="s">&quot;&quot;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">projectCode</span><span class="o">)){</span>
</span><span class='line'>            <span class="n">LOGGER</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="s">&quot;projectCode is null &quot;</span><span class="o">);</span>
</span><span class='line'>            <span class="n">FacesMessage</span> <span class="n">msg</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FacesMessage</span><span class="o">(</span><span class="s">&quot;项目ID为空请重试!&quot;</span><span class="o">);</span>
</span><span class='line'>            <span class="n">JSFUtils</span><span class="o">.</span><span class="na">getFacesContext</span><span class="o">().</span><span class="na">addMessage</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="n">msg</span><span class="o">);</span>
</span><span class='line'>            <span class="k">return</span> <span class="s">&quot;NO&quot;</span><span class="o">;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="cm">/******</span>
</span><span class='line'><span class="cm">         * </span>
</span><span class='line'><span class="cm">         * 生成发出专业SQL,生成接受专业SQL</span>
</span><span class='line'><span class="cm">         * </span>
</span><span class='line'><span class="cm">         * ****/</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">sendSql</span><span class="o">=</span><span class="s">&quot; xSPECIALTY &lt;matches&gt; `NULL` &quot;</span><span class="o">;</span>
</span><span class='line'>        <span class="n">String</span> <span class="n">receiveSql</span><span class="o">=</span><span class="s">&quot; xRCV_MAJOR &lt;matches&gt; `NULL` &quot;</span><span class="o">;</span>
</span><span class='line'>        <span class="k">if</span><span class="o">(</span><span class="n">spcCode</span><span class="o">==</span><span class="kc">null</span><span class="o">||</span><span class="n">spcCode</span><span class="o">.</span><span class="na">size</span><span class="o">()==</span><span class="mi">0</span><span class="o">){</span>
</span><span class='line'>            <span class="n">LOGGER</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="s">&quot;spcCode is null or size is 0&quot;</span><span class="o">);</span>
</span><span class='line'>            <span class="k">return</span> <span class="s">&quot;NO&quot;</span><span class="o">;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&lt;</span><span class="n">spcCode</span><span class="o">.</span><span class="na">size</span><span class="o">();</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'>            <span class="n">sendSql</span><span class="o">=</span><span class="n">sendSql</span><span class="o">+</span><span class="s">&quot; &lt;OR&gt; &quot;</span><span class="o">+</span><span class="s">&quot;xSPECIALTY &lt;matches&gt; `&quot;</span><span class="o">+</span><span class="n">spcCode</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">)+</span><span class="s">&quot;` &quot;</span><span class="o">;</span>
</span><span class='line'>            <span class="n">receiveSql</span><span class="o">=</span><span class="n">receiveSql</span><span class="o">+</span><span class="s">&quot; &lt;OR&gt; &quot;</span><span class="o">+</span><span class="s">&quot;xRCV_MAJOR &lt;matches&gt; `&quot;</span><span class="o">+</span><span class="n">spcCode</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">)+</span><span class="s">&quot;` &quot;</span><span class="o">;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>        <span class="n">sendSql</span><span class="o">=</span><span class="s">&quot;(&quot;</span><span class="o">+</span><span class="n">sendSql</span><span class="o">+</span><span class="s">&quot;) &lt;AND&gt; dDocType &lt;matches&gt; `PJT-INTERFACE-DOC` &lt;AND&gt; xPROJECT_NUM &lt;starts&gt; `&quot;</span><span class="o">+</span><span class="n">projectCode</span><span class="o">+</span><span class="s">&quot;`&quot;</span><span class="o">;</span>
</span><span class='line'>        <span class="n">receiveSql</span><span class="o">=</span><span class="s">&quot;(&quot;</span><span class="o">+</span><span class="n">receiveSql</span><span class="o">+</span><span class="s">&quot;) &lt;AND&gt; dDocType &lt;matches&gt; `PJT-INTERFACE-DOC` &lt;AND&gt; xPROJECT_NUM &lt;starts&gt; `&quot;</span><span class="o">+</span><span class="n">projectCode</span><span class="o">+</span><span class="s">&quot;`&quot;</span><span class="o">;</span>
</span><span class='line'>        <span class="n">LOGGER</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="s">&quot;sendSql:&quot;</span><span class="o">+</span><span class="n">sendSql</span><span class="o">);</span>
</span><span class='line'>        <span class="n">LOGGER</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="s">&quot;receiveSql:&quot;</span><span class="o">+</span><span class="n">receiveSql</span><span class="o">);</span>
</span><span class='line'>        <span class="cm">/*** </span>
</span><span class='line'><span class="cm">         * 查询当前用户在该项目中的专业（ME,EL等)，拼接QueryText</span>
</span><span class='line'><span class="cm">         * dDocType &lt;matches&gt; `PJT-INTERFACE-DOC`</span>
</span><span class='line'><span class="cm">         * ******/</span>
</span><span class='line'>        <span class="n">UCMAdapter</span> <span class="n">ap</span><span class="o">=</span><span class="k">new</span> <span class="n">UCMAdapter</span><span class="o">();</span>
</span><span class='line'>        <span class="k">this</span><span class="o">.</span><span class="na">sendDocumentList</span> <span class="o">=</span> <span class="o">(</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;)</span><span class="n">ap</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">userId</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">sendSql</span><span class="o">);</span>
</span><span class='line'>        <span class="k">this</span><span class="o">.</span><span class="na">receiveDocumentList</span> <span class="o">=</span> <span class="o">(</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;)</span><span class="n">ap</span><span class="o">.</span><span class="na">search</span><span class="o">(</span><span class="n">userId</span><span class="o">.</span><span class="na">toString</span><span class="o">(),</span> <span class="n">receiveSql</span><span class="o">);</span>
</span><span class='line'>        <span class="n">LOGGER</span><span class="o">.</span><span class="na">severe</span><span class="o">(</span><span class="s">&quot;success init...YES.&quot;</span><span class="o">);</span>
</span><span class='line'>        <span class="k">return</span> <span class="s">&quot;YES&quot;</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setReceiveDocumentList</span><span class="o">(</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;</span> <span class="n">receiveDocumentList</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">this</span><span class="o">.</span><span class="na">receiveDocumentList</span> <span class="o">=</span> <span class="n">receiveDocumentList</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;</span> <span class="nf">getReceiveDocumentList</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">receiveDocumentList</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setSendDocumentList</span><span class="o">(</span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;</span> <span class="n">sendDocumentList</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">this</span><span class="o">.</span><span class="na">sendDocumentList</span> <span class="o">=</span> <span class="n">sendDocumentList</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">Document</span><span class="o">&gt;</span> <span class="nf">getSendDocumentList</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="k">return</span> <span class="n">sendDocumentList</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-10-23/ding-zhi-webcenterde-people-connectionzu-jian/">定制webcenter的people Connection组件</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-10-23T22:17:00+08:00" pubdate data-updated="true">Oct 23<span>rd</span>, 2014</time>
        
         | <a href="/blog/2014-10-23/ding-zhi-webcenterde-people-connectionzu-jian/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h4><i class="icon-file"></i>   需求：</h4>

<p>webcenter的people connection类似于微博的关注粉丝功能，现在需要利用程序让某一用户自动关注一批人员。比如某一用户所在项目<code>(PROJECT1)</code>下有10个成员，则该用户进入portal的时候默认就展示其项目下的10个成员在某一分组<code>(PROJECT1)</code>下。</p>

<h4><i class="icon-folder-open"></i> 分析：</h4>

<p>根据项目PROJECT1可以查询出10个成员名；
利用API将10个成员添加到Connections中；
利用API创建Connection list，也即是分组名<code>(PROJECT1)</code>；
将10个成员的Connection 添加到分组PROJECT1中。</p>

<h4><i class="icon-pencil"></i> 技术实现：</h4>

<ul>
<li>根据项目PROJECT1可以查询出10个成员名；
在AMimpl中创建查询成员名方法以List返回结果。</li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'>  <span class="k">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">getAllMembersByProjectId</span><span class="p">(</span><span class="n">String</span> <span class="n">proId</span><span class="p">)</span><span class="err">{</span>
</span><span class='line'>        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="k">result</span><span class="o">=</span><span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">();</span>
</span><span class='line'>        <span class="k">result</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="ss">&quot;CG02&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">result</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="ss">&quot;CG03&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">result</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="ss">&quot;CG04&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">result</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="ss">&quot;CG05&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">result</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="ss">&quot;pierre&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">result</span><span class="p">.</span><span class="k">add</span><span class="p">(</span><span class="ss">&quot;weblogic&quot;</span><span class="p">);</span>
</span><span class='line'>        <span class="o">//</span><span class="n">TODO</span> <span class="err">根据项目</span><span class="n">ID</span> <span class="n">proId</span><span class="err">查询出项目所有成员以</span><span class="n">List</span><span class="err">返回</span>
</span><span class='line'>        <span class="k">return</span> <span class="k">result</span><span class="p">;</span>
</span><span class='line'>    <span class="err">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>利用API将10个成员添加到Connections中；
oracle.webcenter.peopleconnections.connections.internal.model.ConnectionsManagerImpl.createConnection 方法可以给两个guid创建Connection</li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="n">ConnectionsServiceFactory</span> <span class="n">fac</span><span class="o">=</span><span class="n">ConnectionsServiceFactory</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
</span><span class='line'><span class="n">ConnectionsManagerImpl</span> <span class="n">cm</span><span class="o">=</span><span class="p">(</span><span class="n">ConnectionsManagerImpl</span><span class="p">)</span><span class="n">fac</span><span class="p">.</span><span class="n">getConnectionsManager</span><span class="p">();</span>
</span><span class='line'> <span class="n">cm</span><span class="p">.</span><span class="n">createConnection</span><span class="p">(</span><span class="n">ownerUserId</span><span class="p">,</span> <span class="n">connectUserId</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>利用API创建Connection list，也即是分组名<code>(PROJECT1)</code>；
ConnectionListsManager.createConnectionList 可以创建分组</li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'> <span class="n">ConnectionsServiceFactory</span> <span class="n">fac</span><span class="o">=</span><span class="n">ConnectionsServiceFactory</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
</span><span class='line'> <span class="n">fac</span><span class="p">.</span><span class="n">getConnectionListsManager</span><span class="p">().</span><span class="n">createConnectionList</span><span class="p">(</span><span class="ss">&quot;PROJECT1&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>将10个成员的Connection 添加到分组PROJECT1中。
利用API ConnectionListsManager.addMembersToConnectionList方法可以将创建好的Connection添加到分组中去。样例代码如下：</li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'><span class="n">ConnectionsServiceFactory</span> <span class="n">fac</span><span class="o">=</span><span class="n">ConnectionsServiceFactory</span><span class="p">.</span><span class="n">getInstance</span><span class="p">();</span>
</span><span class='line'><span class="n">fac</span><span class="p">.</span><span class="n">getConnectionListsManager</span><span class="p">().</span><span class="n">addMembersToConnectionList</span><span class="p">(</span><span class="n">List</span><span class="p">,</span> <span class="ss">&quot;PROJECT1&quot;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>创建Webcenter Portal Server Extension应用，创建TaskFlow调用以上方法；发布扩展应用到spaces，重启spaces，定义resource catalog应用到portal上即可。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-09-17/dong-tai-gai-bian-lovde-zhi-ji/">动态改变LOV的值集</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-17T18:01:00+08:00" pubdate data-updated="true">Sep 17<span>th</span>, 2014</time>
        
         | <a href="/blog/2014-09-17/dong-tai-gai-bian-lovde-zhi-ji/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h4><i class="icon-file"></i>   需求：</h4>

<p>LOV的值集需要根据传入的用户角色类型(A,B,C)动态改变，A时查询所有，B时过滤字段1，C时过滤字段2.</p>

<p> <strong>基础VO的SQL如下:</strong></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'> <span class="k">SELECT</span> <span class="k">DISTINCT</span> <span class="n">U</span><span class="p">.</span><span class="n">USER_ID</span><span class="p">,</span> <span class="n">U</span><span class="p">.</span><span class="n">USER_NAME</span><span class="p">,</span> <span class="n">F</span><span class="p">.</span><span class="n">FULL_NAME</span> <span class="k">AS</span> <span class="n">DESCRIPTION</span>
</span><span class='line'>  <span class="k">FROM</span> <span class="n">FND_USER</span> <span class="n">U</span><span class="p">,</span> <span class="n">PO_HEADERS_ALL</span> <span class="n">P</span><span class="p">,</span> <span class="n">PO_VENDORS</span> <span class="n">V</span><span class="p">,</span> <span class="n">PER_PEOPLE_F</span> <span class="n">F</span>
</span><span class='line'> <span class="k">WHERE</span> <span class="n">U</span><span class="p">.</span><span class="n">EMPLOYEE_ID</span> <span class="o">=</span> <span class="n">P</span><span class="p">.</span><span class="n">AGENT_ID</span>
</span><span class='line'>   <span class="k">AND</span> <span class="n">P</span><span class="p">.</span><span class="n">VENDOR_ID</span> <span class="o">=</span> <span class="n">V</span><span class="p">.</span><span class="n">VENDOR_ID</span>
</span><span class='line'>   <span class="k">AND</span> <span class="n">F</span><span class="p">.</span><span class="n">PERSON_ID</span><span class="p">(</span><span class="o">+</span><span class="p">)</span> <span class="o">=</span> <span class="n">U</span><span class="p">.</span><span class="n">EMPLOYEE_ID</span>
</span><span class='line'>   <span class="k">AND</span> <span class="n">P</span><span class="p">.</span><span class="n">APPROVED_FLAG</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span>
</span><span class='line'>   <span class="k">AND</span> <span class="p">((</span><span class="n">P</span><span class="p">.</span><span class="n">VENDOR_ID</span> <span class="o">=</span> <span class="p">:</span><span class="n">VARVENDORID</span> <span class="k">AND</span> <span class="p">:</span><span class="n">VARUSERTYPE</span> <span class="o">=</span> <span class="s1">&#39;B&#39;</span><span class="p">)</span> <span class="k">OR</span>
</span><span class='line'>       <span class="p">(:</span><span class="n">VARUSERTYPE</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="k">OR</span>
</span><span class='line'>       <span class="p">(:</span><span class="n">VARUSERTYPE</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span> <span class="k">AND</span> <span class="n">U</span><span class="p">.</span><span class="n">USER_ID</span> <span class="o">=</span> <span class="p">:</span><span class="n">VARUSERID</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>


<p>创建VARUSERTYPE VARUSERID VARVENDORID 三个绑定变量。</p>

<h4><i class="icon-folder-open"></i> 创建LOV VO</h4>

<p> <strong>LVO的SQL如下:</strong></p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='sql'><span class='line'> <span class="k">SELECT</span> <span class="k">NULL</span>         <span class="k">AS</span> <span class="n">USER_ID</span><span class="p">,</span>
</span><span class='line'>       <span class="k">NULL</span>         <span class="k">AS</span> <span class="n">USER_NAME</span><span class="p">,</span>
</span><span class='line'>       <span class="k">NULL</span>         <span class="k">AS</span> <span class="n">DESCRIPTION</span><span class="p">,</span>
</span><span class='line'>       <span class="p">:</span><span class="n">VARTYPE</span>     <span class="k">AS</span> <span class="n">USERTYPE</span><span class="p">,</span>
</span><span class='line'>       <span class="p">:</span><span class="n">VARVENDORID</span> <span class="k">AS</span> <span class="n">VENDORID</span><span class="p">,</span>
</span><span class='line'>       <span class="p">:</span><span class="n">VARUSERID</span>   <span class="k">AS</span> <span class="n">CURRENTUSERID</span>
</span><span class='line'>  <span class="k">FROM</span> <span class="n">DUAL</span>
</span></code></pre></td></tr></table></div></figure>


<p>技巧在这里，LVO同样创建三个绑定变量，并把绑定变量作为VO的attribute暴露出来，然后通过view Accessors传递给基础VO</p>

<h4><i class="icon-pencil"></i> 设置View Accessors</h4>

<ul>
<li>创建LOV</li>
</ul>


<p><img src="../../../wp-content/uploads/QQ20140916174007.png" alt="" /></p>

<ul>
<li>设置View Accessors</li>
</ul>


<p><img src="../../../wp-content/uploads/QQ20140916174112.png" alt="" /></p>

<p>这样就可以实现动态切换LOV的基础数据源了。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-08-26/webcenter-portaldiao-yong-document-service/">Webcenter Portal调用document Service</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-26T18:46:00+08:00" pubdate data-updated="true">Aug 26<span>th</span>, 2014</time>
        
         | <a href="/blog/2014-08-26/webcenter-portaldiao-yong-document-service/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>平台:</strong> webcenter 1.8</p>

<h4><i class="icon-file"></i> Webcenter Contents端配置</h4>

<blockquote><p><strong>步骤:</strong></p>

<ul>
<li>进入webcenter contents http://192.168.15.251:16210/cs/idcplg</li>
<li>展开administration目录</li>
<li>Admin Server节点</li>
<li>Component Manager 里</li>
<li>开启以下特性<code>FrameworkFolders</code>(原<code>Floder_g</code>，已被<code>FrameworkFolders</code>替代)，<code>WebCenterConfigure</code>, <code>DynamicConverter</code></li>
<li>重启UCM</li>
</ul>
</blockquote>

<h4><i class="icon-file"></i>  Webcenter Portal端配置</h4>

<blockquote><p><strong>进入Portal管理界面:</strong></p>

<ul>
<li>切换到Portals标签</li>
<li>Tools and Services菜单里</li>
<li>设置Documents服务为enabled即可</li>
</ul>
</blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-08-25/chuang-jian-content-repositoryshi-chu-xian-cuo-wu/">创建Content Repository时出现错误</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-08-25T18:02:00+08:00" pubdate data-updated="true">Aug 25<span>th</span>, 2014</time>
        
         | <a href="/blog/2014-08-25/chuang-jian-content-repositoryshi-chu-xian-cuo-wu/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><h4><i class="icon-file"></i><strong>创建Content Repository时出现错误：</strong></h4>

<blockquote><p><strong>NOTE:</strong></p>

<ul>
<li>Unable to load content server metadata model using GET_DOC_METADATA_INFO.</li>
<li>Permission denied. Address &#8216;XX.XX.XX.XX&#8217; is not an allowable remote socket address</li>
</ul>
</blockquote>

<h4><i class="icon-file"></i> <strong>解决方法:</strong></h4>

<blockquote><ul>
<li><p><i class="icon-pencil"></i> 找到config.cfg   <br/>
<code>/u02/app/oraucm/fmw_home/user_projects/domains/ecm_domain/ucm/cs/config/config.cfg</code></p></li>
<li><p><i class="icon-pencil"></i>在SocketHostAddressSecurityFilter值加上<code>|*.*.*.*</code>
SocketHostAddressSecurityFilter=127.0.0.1|192.168.15.163|<code>*.*.*.*</code>即可</p></li>
</ul>
</blockquote>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-06-03/oafge-xing-hua-buttonhuo-qu-ye-mian-can-shu/">OAF个性化Button获取页面参数</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-06-03T11:19:00+08:00" pubdate data-updated="true">Jun 3<span>rd</span>, 2014</time>
        
         | <a href="/blog/2014-06-03/oafge-xing-hua-buttonhuo-qu-ye-mian-can-shu/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li>平台: R12</li>
<li>需求: 需要个性化一个button的Destination URI属性，并添附上一个参数。</li>
</ul>


<p>实现方法：</p>

<ol>
<li><p>本来重写CO便很容易实现该需求，但是涉及到修改代码以及各个环境更新就很麻烦了，所以如果个性化button的URL是最方便了。</p></li>
<li><p>个性化又涉及到如何在URL里传递参数的问题。</p></li>
</ol>


<p>右键当前页面，查看源代码如下：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>...
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;form</span> <span class="na">id=</span><span class="s">&quot;DefaultFormName&quot;</span> <span class="na">name=</span><span class="s">&quot;DefaultFormName&quot;</span> <span class="na">style=</span><span class="s">&quot;margin:0px&quot;</span> <span class="na">method=</span><span class="s">&quot;POST&quot;</span> <span class="na">action=</span><span class="s">&quot;/OA_HTML/OA.jsp?page=/oracle/apps/pa/deliverable/webui/CrUpDeliverablePG&amp;paCallingPage=DLVLIST&amp;paCallingMode=VIEW&amp;paProjectId=106691&amp;paDeliverableId=113287&amp;paDlvrItemId=106962&amp;&amp;addBreadCrumb=RP&amp;_ti=1696581738&amp;PersonalizationParam=PersonalizationParamAdmin&amp;retainAM=Y&amp;oapc=28&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>
</span><span class='line'>...
</span></code></pre></td></tr></table></div></figure>


<p>需要将当前页面中form标签的action属性中的paDlvrItemId参数的值获取过来。拼接成形如:http://dengdezhao.cn?erpid={:paDlvrItemId}形式的URL赋给button的destinationURI属性。</p>

<ol>
<li>使用{@itemName}这种方式只能在table控件中才行，在此处不适用。因此考虑使用JS查找当前页面获取到参数然后拼接形成URL。</li>
</ol>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>http://192.168.15.141/login/LoginSSO.jsp?flowCode=AM02<span class="err">&amp;</span>erpid=&#39;+unescape(document.DefaultFormName.action.match(new RegExp(&quot;(^|<span class="err">&amp;</span>)&quot; + &#39;paDlvrItemId&#39; + &quot;=([^<span class="err">&amp;</span>]*)(<span class="err">&amp;</span>|$)&quot;, &quot;i&quot;))[2])+&#39;<span class="err">&amp;</span>workcode=&#39; + document.getElementById(&#39;AdditionalInfo&#39;).rows[4].cells[1].innerText + &#39;
</span></code></pre></td></tr></table></div></figure>


<ol>
<li>将以上URL个性化赋值给button即可满足需求。</li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-04-18/an-zhuang-rcu1-dot-7yu-dao-de-xiao-wen-ti/">安装RCU1.7遇到的小问题</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-04-18T20:24:00+08:00" pubdate data-updated="true">Apr 18<span>th</span>, 2014</time>
        
         | <a href="/blog/2014-04-18/an-zhuang-rcu1-dot-7yu-dao-de-xiao-wen-ti/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li>环境：此前安装过soa1.6，最近重新安装soa1.7时遇到的问题</li>
<li>安装Rcu1.7时，发现无法运行./rcu,错误提示如下：</li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">rcuHome</span><span class="o">/</span><span class="n">jdk</span><span class="o">/</span><span class="n">jre</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="nl">java:</span> <span class="n">cannot</span> <span class="n">execute</span> <span class="n">binary</span> <span class="n">file</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>


<p>查看操作系统发现是32bit,而rcu只有64bit的。</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="n">$getconf</span> <span class="n">LONG_BIT</span>
</span><span class='line'><span class="mi">32</span>
</span></code></pre></td></tr></table></div></figure>


<p>在32bit系统上安装64bit软件向下兼容应该是可以安装的，因此怀疑是jdk的问题。</p>

<p>修改rcu文件最后几行的jre_home 为中间件文件夹中的JDK：/home/pierre/Oracle/Middleware/jdk160_24/bin/java 后，重新运行即可解决该问题。</p>

<ul>
<li><p>成功运行rcu之后，进入配置oracle数据库信息页，一直报 invalid service 错误, 原来是service name 要加上机器名后缀 orcl.localdomain即正常。</p></li>
<li><p>因为之前安装过rcu1.6，所以需要将此前的mds删除掉，不然在创建soa domain的时候会出现错误。</p></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014-02-07/%E5%AE%9A%E5%88%B6EL/">定制EL Function</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-02-07T19:24:00+08:00" pubdate data-updated="true">Feb 7<span>th</span>, 2014</time>
        
         | <a href="/blog/2014-02-07/%E5%AE%9A%E5%88%B6EL/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>平台: Jdeveloper 12c</p></li>
<li><p>有时需要对字符串进行一些后再显示出来，可以写一个简单的taglib来实现，以下Demo是处理一个以冒号分隔的字符串，返回其中的第三个值。比如输入“aaa:bbb:ccc:ddd&#8221;，输出&#8221;ccc&#8221;。</p></li>
</ul>


<h4>实现方法</h4>

<p>创建一个空的java Project：Taglib</p>

<ul>
<li>创建Java类：SplitString.java</li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">cn</span><span class="o">.</span><span class="na">dengdezhao</span><span class="o">.</span><span class="na">taglib</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">SplitString</span> <span class="o">{</span>
</span><span class='line'>
</span><span class='line'>    <span class="kd">public</span> <span class="kd">static</span> <span class="n">String</span> <span class="nf">getString</span><span class="o">(</span><span class="n">String</span> <span class="n">string</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">String</span><span class="o">[]</span> <span class="n">strings</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="na">split</span><span class="o">(</span><span class="s">&quot;:&quot;</span><span class="o">,</span> <span class="mi">3</span><span class="o">);</span>
</span><span class='line'>        <span class="k">if</span> <span class="o">(</span><span class="n">strings</span><span class="o">.</span><span class="na">length</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="n">strings</span><span class="o">[</span><span class="mi">2</span><span class="o">];</span>
</span><span class='line'>        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'>            <span class="k">return</span> <span class="s">&quot;&quot;</span><span class="o">;</span>
</span><span class='line'>        <span class="o">}</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>创建taglib描述文件splitString.tld</li>
</ul>


<p>New -> From Gallery -> Web Tier -> JSP -> JSP Tag Library</p>

<p>类型为Deployable 文件内容如下：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="cp">&lt;?xml version = &#39;1.0&#39; encoding = &#39;UTF-8&#39;?&gt;</span>
</span><span class='line'><span class="nt">&lt;taglib</span> <span class="na">xmlns:xsi=</span><span class="s">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span>
</span><span class='line'>        <span class="na">xsi:schemaLocation=</span><span class="s">&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-jsptaglibrary_2_1.xsd&quot;</span>
</span><span class='line'>        <span class="na">version=</span><span class="s">&quot;2.1&quot;</span> <span class="na">xmlns=</span><span class="s">&quot;http://java.sun.com/xml/ns/javaee&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;description&gt;</span>split String<span class="nt">&lt;/description&gt;</span>
</span><span class='line'>  <span class="nt">&lt;display-name&gt;</span>splitString<span class="nt">&lt;/display-name&gt;</span>
</span><span class='line'>  <span class="nt">&lt;tlib-version&gt;</span>1.0<span class="nt">&lt;/tlib-version&gt;</span>
</span><span class='line'>  <span class="nt">&lt;short-name&gt;</span>splitString<span class="nt">&lt;/short-name&gt;</span>
</span><span class='line'>  <span class="nt">&lt;uri&gt;</span>http://www.dengdezhao.cn/string<span class="nt">&lt;/uri&gt;</span>
</span><span class='line'>  <span class="nt">&lt;function&gt;</span>
</span><span class='line'>    <span class="nt">&lt;display-name&gt;</span>getString<span class="nt">&lt;/display-name&gt;</span>
</span><span class='line'>    <span class="nt">&lt;name&gt;</span>getString<span class="nt">&lt;/name&gt;</span>
</span><span class='line'>    <span class="nt">&lt;function-class&gt;</span>cn.dengdezhao.taglib.SplitString<span class="nt">&lt;/function-class&gt;</span>
</span><span class='line'>    <span class="nt">&lt;function-signature&gt;</span>java.lang.String getString(java.lang.String)<span class="nt">&lt;/function-signature&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/function&gt;</span>
</span><span class='line'><span class="nt">&lt;/taglib&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>将该工程发布为jar包。即完成taglib的开发工作。</li>
</ul>


<h4>在工程中应用该taglib</h4>

<ul>
<li>创建测试工程ViewController</li>
</ul>


<p>右键工程属性 -> JSP Tag Libraries -> Add</p>

<p>将之前发布的Jar包添加进来。</p>

<ul>
<li>创建测试页面testTaglib.jspx</li>
</ul>


<p>内容如下 ：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='jsp'><span class='line'><span class="cp">&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39;?&gt;</span>
</span><span class='line'><span class="nt">&lt;jsp:root</span> <span class="na">xmlns:jsp=</span><span class="s">&quot;http://java.sun.com/JSP/Page&quot;</span> <span class="na">version=</span><span class="s">&quot;2.1&quot;</span> <span class="na">xmlns:f=</span><span class="s">&quot;http://java.sun.com/jsf/core&quot;</span> <span class="na">xmlns:myTag=</span><span class="s">&quot;http://www.dengdezhao.cn/string&quot;</span>
</span><span class='line'>          <span class="na">xmlns:af=</span><span class="s">&quot;http://xmlns.oracle.com/adf/faces/rich&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>    <span class="nt">&lt;jsp:directive.page</span> <span class="na">contentType=</span><span class="s">&quot;text/html;charset=UTF-8&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>    <span class="nt">&lt;f:view&gt;</span>
</span><span class='line'>        <span class="nt">&lt;af:document</span> <span class="na">title=</span><span class="s">&quot;testTaglib.jspx&quot;</span> <span class="na">id=</span><span class="s">&quot;d1&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;af:form</span> <span class="na">id=</span><span class="s">&quot;f1&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>            <span class="nt">&lt;af:outputText</span> <span class="na">id=</span><span class="s">&quot;ot1&quot;</span> <span class="na">value=</span><span class="s">&quot;#{myTag:getString(&#39;aaa:ddd:ccc&#39;)}&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>            <span class="nt">&lt;/af:form&gt;</span>
</span><span class='line'>        <span class="nt">&lt;/af:document&gt;</span>
</span><span class='line'>    <span class="nt">&lt;/f:view&gt;</span>
</span><span class='line'><span class="nt">&lt;/jsp:root&gt;</span>
</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013-11-09/you-yi-wai-duan-dian-dao-zhi-oracle11gqi-dong-bu-qi-lai-de-wen-ti-jie-jue/">由意外断电导致oracle11g启动不起来的问题解决</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-11-09T19:24:00+08:00" pubdate data-updated="true">Nov 9<span>th</span>, 2013</time>
        
         | <a href="/blog/2013-11-09/you-yi-wai-duan-dian-dao-zhi-oracle11gqi-dong-bu-qi-lai-de-wen-ti-jie-jue/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>平台: linux + oracle 11g</p></li>
<li><p>故障: 意外断电之后，监听启动不了</p></li>
</ul>


<h4>解决方法</h4>

<p>执行<code>lsnrctrl start</code>命令时报错误代码如下：</p>

<p><code>TNS-12537</code>  <br/>
<code>TNS-12560</code>  <br/>
<code>TNS-00507</code>  <br/>
<code>Linux Error:29</code></p>

<ul>
<li><p>检查/etc/hosts文件，没有发现异常。</p></li>
<li><p>因为未改动任何配置文件，所以基本可以确定是断电造成文件损坏而引起。于是使用<code>relink all</code>看看能否解决该问题。</p></li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'> <span class="err">#</span> <span class="n">cd</span> <span class="n">$ORACLE_HOME</span><span class="o">/</span><span class="n">bin</span>
</span><span class='line'> <span class="err">#</span> <span class="n">relink</span> <span class="n">all</span>
</span></code></pre></td></tr></table></div></figure>


<p>执行<code>relink all</code>命令之后，再执行<code>lsnrctrl start</code>时，发现不报之前的错误了，出现了新的错误：</p>

<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'> <span class="n">symbol</span> <span class="n">lookup</span> <span class="nl">error:</span> <span class="n">$ORACLE_HOME</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">libclntsh</span><span class="o">.</span><span class="na">so</span><span class="o">.</span><span class="mf">11.1</span>
</span><span class='line'><span class="o">:</span> <span class="n">undefined</span> <span class="nl">symbol:</span> <span class="n">nnftboot</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><p>看来是这个libclntsh.so.11.1出了问题，于是尝试去下载该文件替换掉。</p></li>
<li><p>从RPM search网站上下载到oracle-instance-client的RPM文件到本地。</p></li>
<li><p>使用rpm2cpio命令抽取出里面的libclntsh.so.11.1</p></li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'>
</span><span class='line'><span class="err">#</span><span class="n">rpm2cpio</span> <span class="n">oracle</span><span class="o">-</span><span class="n">instance</span><span class="o">-</span><span class="n">client</span><span class="o">-</span><span class="n">xxx</span><span class="o">.</span><span class="na">rpm</span> <span class="o">|</span> <span class="n">cpio</span> <span class="o">-</span><span class="n">div</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>将得到的libclntsh.so.11.1文件替换掉$ORACLE_HOME/lib下的重名文件即可。</li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013-09-23/ru-he-zai-ye-mian-sui-pian-jia-zai-qian-diao-yong-luo-ji/">如何在页面碎片加载前调用逻辑</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-09-23T18:32:00+08:00" pubdate data-updated="true">Sep 23<span>rd</span>, 2013</time>
        
         | <a href="/blog/2013-09-23/ru-he-zai-ye-mian-sui-pian-jia-zai-qian-diao-yong-luo-ji/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li><p>平台:Jdeveloper 12c</p></li>
<li><p>需求：在JSPX页面加载前如果需要调用逻辑可以通过重写PhaseListener实现，如果在JSFF页面碎片加载前（也即是region加载前）调用应该如何实现？</p></li>
</ul>


<p><strong>实现方法</strong></p>

<p>重写RegionController方法可以达到以上需求。</p>

<ul>
<li>重写 RegionController类，在refreshRegion方法中加入需要调用的逻辑即可在页面碎片加载之前调用。</li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kn">package</span> <span class="n">cn</span><span class="o">.</span><span class="na">dengdezhao</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">oracle.adf.model.RegionContext</span><span class="o">;</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">oracle.adf.model.RegionController</span><span class="o">;</span>
</span><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">myController</span> <span class="kd">implements</span> <span class="n">RegionController</span> <span class="o">{</span>
</span><span class='line'>    <span class="kd">public</span> <span class="nf">myController</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="kd">super</span><span class="o">();</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">refreshRegion</span><span class="o">(</span><span class="n">RegionContext</span> <span class="n">regionContext</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="c1">// TODO Implement this method</span>
</span><span class='line'>        <span class="kt">int</span> <span class="n">flag</span><span class="o">=</span><span class="n">regionContext</span><span class="o">.</span><span class="na">getRefreshFlag</span><span class="o">();</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&quot;refreshRegion...&quot;</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">validateRegion</span><span class="o">(</span><span class="n">RegionContext</span> <span class="n">regionContext</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="c1">// TODO Implement this method</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isRegionViewable</span><span class="o">(</span><span class="n">RegionContext</span> <span class="n">regionContext</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="c1">// TODO Implement this method</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="kc">false</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="nd">@Override</span>
</span><span class='line'>    <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
</span><span class='line'>        <span class="c1">// TODO Implement this method</span>
</span><span class='line'>
</span><span class='line'>        <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>配置页面碎片pagedef页</li>
</ul>


<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;</span>
</span><span class='line'><span class="nt">&lt;pageDefinition</span> <span class="na">xmlns=</span><span class="s">&quot;http://xmlns.oracle.com/adfm/uimodel&quot;</span> <span class="na">version=</span><span class="s">&quot;12.1.2.66.68&quot;</span> <span class="na">id=</span><span class="s">&quot;iteratorInputPageDef&quot;</span>
</span><span class='line'>                <span class="na">ControllerClass=</span><span class="s">&quot;cn.dengdezhao.myController&quot;</span>
</span><span class='line'>                <span class="na">Package=</span><span class="s">&quot;cn.dengdezhao.pageDefs&quot;</span><span class="nt">&gt;</span>
</span><span class='line'>  <span class="nt">&lt;parameters/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;executables&gt;</span>
</span><span class='line'>    <span class="nt">&lt;variableIterator</span> <span class="na">id=</span><span class="s">&quot;variables&quot;</span><span class="nt">/&gt;</span>
</span><span class='line'>  <span class="nt">&lt;/executables&gt;</span>
</span><span class='line'>  <span class="nt">&lt;bindings/&gt;</span>
</span><span class='line'><span class="nt">&lt;/pageDefinition&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p><strong>结论</strong></p>

<p>通过重写regionController类可以实现在页面碎片加载前调用POPUP提示等之类的需求。</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>分类目录</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/adf/'>ADF (34)</a></li>
<li class='category'><a href='/blog/categories/ebs/'>EBS (2)</a></li>
<li class='category'><a href='/blog/categories/oaf/'>OAF (9)</a></li>
<li class='category'><a href='/blog/categories/oracle/'>Oracle (8)</a></li>
<li class='category'><a href='/blog/categories/soa/'>SOA (3)</a></li>
<li class='category'><a href='/blog/categories/sinaappengine/'>SinaAppEngine (1)</a></li>
<li class='category'><a href='/blog/categories/forms/'>forms (1)</a></li>
<li class='category'><a href='/blog/categories/java/'>java (2)</a></li>
<li class='category'><a href='/blog/categories/jdeveloper/'>jdeveloper (1)</a></li>
<li class='category'><a href='/blog/categories/linux/'>linux (2)</a></li>
<li class='category'><a href='/blog/categories/mysql/'>mysql (1)</a></li>
<li class='category'><a href='/blog/categories/octopress/'>octopress (1)</a></li>
<li class='category'><a href='/blog/categories/others/'>others (1)</a></li>
<li class='category'><a href='/blog/categories/webcenter/'>webcenter (4)</a></li>
<li class='category'><a href='/blog/categories/weblogic/'>weblogic (1)</a></li>
<li class='category'><a href='/blog/categories/wordpress/'>wordpress (1)</a></li>

  </ul>
</section>
<section>
  <h1>最新发表</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2014-11-28/shi-yong-ridczai-webcenter-portalji-cheng-ecmde-wen-dang-cha-xun-gong-neng/">使用RIDC在webcenter portal集成ECM的文档查询功能</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-10-23/ding-zhi-webcenterde-people-connectionzu-jian/">定制webcenter的people connection组件</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-09-17/dong-tai-gai-bian-lovde-zhi-ji/">动态改变LOV的值集</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-08-26/webcenter-portaldiao-yong-document-service/">webcenter portal调用document service</a>
      </li>
    
      <li class="post">
        <a href="/blog/2014-08-25/chuang-jian-content-repositoryshi-chu-xian-cuo-wu/">创建Content Repository时出现错误</a>
      </li>
    
  </ul>
</section>




<section>
  <h1>友情链接</h1>
  <ul>
  	<li><a href="http://www.liqifa.com">[小分号]</a></li>
 	<li><a href="http://www.fmw007.com">[梦想左岸]</a></li>
 	<li><a href="http://oraclefmw.blog.163.com/">[追梦]</a></li>
 	<li><a href="http://blog.csdn.net/ygj26">[小尹妹纸]</a></li>
 	<li><a href="http://oracleseeker.com/">[OracleSeeker，Oracle探索者]</a></li>
  </ul>
</section>

<section>
<h1>新浪微博</h1>
<ul id="weibo">
<li>
<iframe
width="100%"
height="550"
class="share_self"
frameborder="0"
scrolling="no"
src="http://widget.weibo.com/weiboshow/index.php?width=0&height=550&ptype=0&speed=0&skin=&isTitle=0&noborder=1&isWeibo=0&isFans=&uid=1774817797&verifier=75ee09e4&colors=17236,003643,004354,00b7ef,ffffff&dpc=1">
</iframe>
</li>
</ul>
</section>


  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2014 - pierreorz -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F2c50098a945120bddaa5f082c4e56cea' type='text/javascript'%3E%3C/script%3E"));
</script>

</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'adfkf';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>











</body>
</html>
